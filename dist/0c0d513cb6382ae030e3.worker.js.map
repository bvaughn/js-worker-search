{"version":3,"sources":["webpack:///webpack/bootstrap 0c0d513cb6382ae030e3","webpack:///./src/worker/Worker.js","webpack:///./src/util/index.js","webpack:///./src/util/SearchUtility.js","webpack:///./src/util/SearchIndex.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;;;;;AC/BA,KAAM,aAAa,GAAG,oBAAmB;;AAEzC,KAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,eAAK,EAAI;OAChC,IAAI,GAAK,KAAK,CAAd,IAAI;OACJ,MAAM,GAAK,IAAI,CAAf,MAAM;;AAEd,WAAQ,MAAM;AACZ,UAAK,eAAe;WACV,GAAG,GAAW,IAAI,CAAlB,GAAG;WAAE,IAAI,GAAK,IAAI,CAAb,IAAI;;AAEjB,oBAAa,CAAC,aAAa,CAAC,GAAG,EAAE,IAAI,CAAC;AACtC,aAAK;AACP,UAAK,QAAQ;WACH,UAAU,GAAY,IAAI,CAA1B,UAAU;WAAE,KAAK,GAAK,IAAI,CAAd,KAAK;;AAEzB,WAAM,OAAO,GAAG,aAAa,CAAC,MAAM,CAAC,KAAK,CAAC;;AAE3C,WAAI,CAAC,WAAW,CAAC,EAAE,UAAU,EAAV,UAAU,EAAE,OAAO,EAAP,OAAO,EAAE,CAAC;AACzC,aAAK;AAAA,IACR;EACF,EAAE,KAAK,CAAC,C;;;;;;;;;;;;;;;;;;;SC3BF,OAAO,2B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KCMO,aAAa;;;;;;AAKhC,YALmB,aAAa,GAKjB;2BALI,aAAa;;AAM9B,SAAI,CAAC,WAAW,GAAG,2BAAiB;AACpC,SAAI,CAAC,IAAI,GAAG,EAAE;IACf;;;;;;;;;AAAA;gBARkB,aAAa;;mCAiBjB,GAAQ,EAAE,IAAY,EAAiB;;;;8BAAd,aAAa;;;;;;;oBAA5B,IAAY;qHAAZ,IAAY;;;AACnC,WAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,IAAI;;AAErB,WAAI,WAA0B,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;;2BAAjE,WAA0B,KAA1B,WAA0B;;;mIAA1B,WAA0B;;;AAE9B,kBAAW,CAAC,OAAO,CAAC,oBAAU,EAAI;AAChC,aAAI,cAA6B,GAAG,MAAK,YAAY,CAAC,UAAU,CAAC;;6BAA7D,cAA6B,KAA7B,cAA6B;;;wIAA7B,cAA6B;;;AAEjC,uBAAc,CAAC,OAAO,CAAC,uBAAa;kBAClC,MAAK,WAAW,CAAC,aAAa,CAAC,aAAa,EAAE,GAAG,CAAC;UAAA,CACnD;QACF,CAAC;;mBAEK,IAAI;MACZ;;;;;;;;;;;;;;;;4BAaO,KAAa,EAAc;;;;;;;;;oBAA3B,KAAa;sHAAb,KAAa;;;AACnB,WAAI,CAAC,KAAK,EAAE;sBACH,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;QAC9B,MAAM;AACL,aAAI,MAAqB,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;;6BAA7D,MAAqB,KAArB,MAAqB;;;gIAArB,MAAqB;;;sBAElB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,MAAM,CAAC;QACvC;MACF;;;;;;;;;;kCAOa,KAAa,EAAiB;;;;;;;;;;;oBAA9B,KAAa;sHAAb,KAAa;;;AACzB,WAAI,cAAc,GAAG,EAAE;;;;;;;;AAQvB,WAAI;AACF,cAAK,IAAI,CAAC,GAAG,CAAC,EAAE,MAAM,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,MAAM,EAAE,EAAE,CAAC,EAAE;AACtD,eAAI,YAAoB,GAAG,EAAE;;AAE7B,gBAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,EAAE,EAAE,CAAC,EAAE;AAC/B,yBAAY,IAAI,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;;0BAA/B,YAAY;mIAAZ,YAAY;;;AACZ,2BAAc,CAAC,IAAI,CAAC,YAAY,CAAC;YAClC;UACF;QACF,CAAC,OAAO,KAAK,EAAE;AACd,gBAAO,CAAC,KAAK,6BAA2B,KAAK,UAAK,KAAK,CAAG;QAC3D;;oBAEM,cAAc;MACtB;;;;;;;;+BAKU,MAAc,EAAU;;;;;;;;;oBAAxB,MAAc;uHAAd,MAAc;;;oBAChB,MAAM,CAAC,IAAI,EAAE,CAAC,iBAAiB,EAAE;MACzC;;;;;;;;+BAKU,IAAY,EAAiB;;;;;;;;;;;oBAA7B,IAAY;qHAAZ,IAAY;;;oBACd,IAAI,CACR,KAAK,CAAC,KAAK,CAAC,CACZ,MAAM,CAAC,cAAI;gBAAI,IAAI;QAAA,CAAC;MACxB;;;UAlGkB,aAAa;;;mBAAb,aAAa;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KCDb,WAAW;AAG9B,YAHmB,WAAW,GAGf;2BAHI,WAAW;;AAI5B,SAAI,CAAC,aAAa,GAAG,EAAE;IACxB;;;;;;;;AAAA;gBALkB,WAAW;;mCAaf,KAAa,EAAE,GAAQ,EAAQ;oBAA/B,KAAa;wHAAb,KAAa;;;AAC1B,WAAI,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,EAAE;AAC9B,aAAI,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,EAAE;QAC/B;;AAED,WAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG;MACrC;;;;;;;;;;;;4BASO,MAAqB,EAAc;;;;;;;;;;;2BAAnC,MAAqB,KAArB,MAAqB;;;gIAArB,MAAqB;;;AAC3B,WAAI,MAAyB,GAAG,EAAE;;aAA9B,MAAyB,oBAAzB,MAAyB,yCAAzB,MAAyB;uIAAzB,MAAyB;;;AAC7B,WAAI,WAAW,GAAG,KAAK;;AAEvB,aAAM,CAAC,OAAO,CAAC,eAAK,EAAI;AACtB,aAAI,aAAgC,GAAG,MAAK,aAAa,CAAC,KAAK,CAAC,IAAI,EAAE;;eAAlE,aAAgC,oBAAhC,aAAgC,yCAAhC,aAAgC;gJAAhC,aAAgC;;;AAEpC,aAAI,CAAC,WAAW,EAAE;AAChB,sBAAW,GAAG,IAAI;;AAElB,gBAAK,IAAI,IAAG,IAAI,aAAa,EAAE;AAC7B,mBAAM,CAAC,IAAG,CAAC,GAAG,aAAa,CAAC,IAAG,CAAC;YACjC;UACF,MAAM;AACL,gBAAK,IAAI,KAAG,IAAI,MAAM,EAAE;AACtB,iBAAI,CAAC,aAAa,CAAC,KAAG,CAAC,EAAE;AACvB,sBAAO,MAAM,CAAC,KAAG,CAAC;cACnB;YACF;UACF;QACF,CAAC;;AAEF,WAAI,IAAgB,GAAG,EAAE;;0BAArB,IAAgB;2HAAhB,IAAgB;;;AAEpB,YAAK,IAAI,KAAG,IAAI,MAAM,EAAE;AACtB,aAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAG,CAAC,CAAC;QACvB;;oBAEM,IAAI;MACZ;;;UAzDkB,WAAW;;;mBAAX,WAAW","file":"0c0d513cb6382ae030e3.worker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 0c0d513cb6382ae030e3\n **/","import SearchUtility from '../util'\n\n/**\n * Search entry point to web worker.\n * Builds search index and performs searches on separate thread from the ui.\n */\n\nconst searchUtility = new SearchUtility()\n\nself.addEventListener('message', event => {\n  const { data } = event\n  const { method } = data\n\n  switch (method) {\n    case 'indexDocument':\n      const { uid, text } = data\n\n      searchUtility.indexDocument(uid, text)\n      break\n    case 'search':\n      const { callbackId, query } = data\n\n      const results = searchUtility.search(query)\n\n      self.postMessage({ callbackId, results })\n      break\n  }\n}, false)\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/worker/Worker.js\n **/","export default from './SearchUtility'\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/index.js\n **/","import SearchIndex from './SearchIndex'\n\n/**\n * Synchronous client-side full-text search utility.\n * Forked from JS search (github.com/bvaughn/js-search).\n */\nexport default class SearchUtility {\n\n  /**\n   * Constructor.\n   */\n  constructor () {\n    this.searchIndex = new SearchIndex()\n    this.uids = {}\n  }\n\n  /**\n   * Adds or updates a uid in the search index and associates it with the specified text.\n   * Note that at this time uids can only be added or updated in the index, not removed.\n   *\n   * @param uid Uniquely identifies a searchable object\n   * @param text Text to associate with uid\n   */\n  indexDocument (uid: any, text: string): SearchUtility {\n    this.uids[uid] = true\n\n    var fieldTokens: Array<string> = this._tokenize(this._sanitize(text))\n\n    fieldTokens.forEach(fieldToken => {\n      var expandedTokens: Array<string> = this._expandToken(fieldToken)\n\n      expandedTokens.forEach(expandedToken =>\n        this.searchIndex.indexDocument(expandedToken, uid)\n      )\n    })\n\n    return this\n  }\n\n  /**\n   * Searches the current index for the specified query text.\n   * Only uids matching all of the words within the text will be accepted.\n   * If an empty query string is provided all indexed uids will be returned.\n   *\n   * Document searches are case-insensitive (e.g. \"search\" will match \"Search\").\n   * Document searches use substring matching (e.g. \"na\" and \"me\" will both match \"name\").\n   *\n   * @param query Searchable query text\n   * @return Array of uids\n   */\n  search (query: string): Array<any> {\n    if (!query) {\n      return Object.keys(this.uids)\n    } else {\n      var tokens: Array<string> = this._tokenize(this._sanitize(query))\n\n      return this.searchIndex.search(tokens)\n    }\n  }\n\n  /**\n   * Index strategy based on 'all-substrings-index-strategy.ts' in github.com/bvaughn/js-search/\n   *\n   * @private\n   */\n  _expandToken (token: string): Array<string> {\n    var expandedTokens = []\n\n    // String.prototype.charAt() may return surrogate halves instead of whole characters.\n    // When this happens in the context of a web-worker it can cause Chrome to crash.\n    // Catching the error is a simple solution for now; in the future I may try to better support non-BMP characters.\n    // Resources:\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/charAt\n    // https://mathiasbynens.be/notes/javascript-unicode\n    try {\n      for (let i = 0, length = token.length; i < length; ++i) {\n        let prefixString: string = ''\n\n        for (let j = i; j < length; ++j) {\n          prefixString += token.charAt(j)\n          expandedTokens.push(prefixString)\n        }\n      }\n    } catch (error) {\n      console.error(`Unable to parse token \"${token}\" ${error}`)\n    }\n\n    return expandedTokens\n  }\n\n  /**\n   * @private\n   */\n  _sanitize (string: string): string {\n    return string.trim().toLocaleLowerCase()\n  }\n\n  /**\n   * @private\n   */\n  _tokenize (text: string): Array<string> {\n    return text\n      .split(/\\s+/)\n      .filter(text => text) // Remove empty tokens\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/SearchUtility.js\n **/","/**\n * Maps search tokens to uids.\n * This structure is used by the Search class to optimize search operations.\n * Forked from JS search (github.com/bvaughn/js-search).\n */\nexport default class SearchIndex {\n  tokenToUidMap: { [token: string]: any }\n\n  constructor () {\n    this.tokenToUidMap = {}\n  }\n\n  /**\n   * Maps the specified token to a uid.\n   *\n   * @param token Searchable token (e.g. \"road\")\n   * @param uid Identifies a document within the searchable corpus\n   */\n  indexDocument (token: string, uid: any): void {\n    if (!this.tokenToUidMap[token]) {\n      this.tokenToUidMap[token] = {}\n    }\n\n    this.tokenToUidMap[token][uid] = uid\n  }\n\n  /**\n   * Finds uids that have been mapped to the set of tokens specified.\n   * Only uids that have been mapped to all tokens will be returned.\n   *\n   * @param tokens Array of searchable tokens (e.g. [\"long\", \"road\"])\n   * @return Array of uids that have been associated with the set of search tokens\n   */\n  search (tokens: Array<string>): Array<any> {\n    let uidMap: {[uid: any]: any} = {}\n    let initialized = false\n\n    tokens.forEach(token => {\n      let currentUidMap: {[uid: any]: any} = this.tokenToUidMap[token] || {}\n\n      if (!initialized) {\n        initialized = true\n\n        for (let uid in currentUidMap) {\n          uidMap[uid] = currentUidMap[uid]\n        }\n      } else {\n        for (let uid in uidMap) {\n          if (!currentUidMap[uid]) {\n            delete uidMap[uid]\n          }\n        }\n      }\n    })\n\n    let uids: Array<any> = []\n\n    for (let uid in uidMap) {\n      uids.push(uidMap[uid])\n    }\n\n    return uids\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/SearchIndex.js\n **/"],"sourceRoot":""}